<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>1A2B Game</title>
</head>
<body>

<h1>114306005_HW7_1A2B</h1>

<input id="guessInput" type="text" placeholder="Enter 4 digits">
<button onclick="play()">Guess</button>

<h3>Record:</h3>
<div id="record"></div>

<script>
    
    let answer = generateAnswer();
    let count = 0;

    function generateAnswer() {
        let digits = ['0','1','2','3','4','5','6','7','8','9'];
        let ans = "";
        for (let i = 0; i < 4; i++) {
            let index = Math.floor(Math.random() * digits.length);
            ans += digits[index];
            digits.splice(index, 1);
        }
        return ans;
    }

    function isValid(str) {
        if (str.length !== 4) return false;
        if (!/^\d{4}$/.test(str)) return false;

        // Check duplicate digits
        let set = new Set(str);
        return set.size === 4;
    }

    function checkAB(guess, ans) {
        let A = 0, B = 0;
        for (let i = 0; i < 4; i++) {
            if (guess[i] === ans[i]) {
                A++;
            } else if (ans.includes(guess[i])) {
                B++;
            }
        }
        return `${A}A${B}B`;
    }

    function play() {
        let inputField = document.getElementById("guessInput");
        let guess = inputField.value;

        // Validate
        if (!isValid(guess)) {
            alert("Invalid input! Must be 4 non-repeating digits.");
            inputField.value = "";
            return;
        }

        count++;

        let result = checkAB(guess, answer);

        document.getElementById("record").innerHTML +=
            `Guess ${count}: ${guess} â†’ ${result}<br>`;

        if (result === "4A0B") {
            alert(`Correct! You guessed it in ${count} attempts!`);
        }

        inputField.value = "";
    }
</script>

</body>
</html>